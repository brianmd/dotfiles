#!/bin/bash
# Usage: clolein [args]+
# Example: clolein new app test
# Example: clolein new luminus test +cljs +swagger +auth

NO_SIDE_EFFECTS=true
source cloprep

if [[ -d $HOME/.m2 ]]; then
    M2_VOLUME="-v $HOME/.m2:$DOCKER_USER_HOME/.m2"
fi

if docker images | grep clolein-image ; then
    echo 'clolein-image is already built'
else
    echo 'building clolein-image'
    (cd $SCRIPT_DIR && docker build -f Dockerfile.clolein -t clolein-image .)
fi


echo "M2:$M2_VOLUME"
docker run \
  -ti \
  --rm \
  --workdir /home/clojure \
  -v $CURR_PATH:/home/clojure \
  $M2_VOLUME \
  clolein-image \
  $@

  # lein $@

# --user $USERID:$GROUPID \

